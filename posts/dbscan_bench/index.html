<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Yonghun Suh">
<meta name="dcterms.date" content="2025-09-09">
<title>How to boost a DBSCAN task – Yonghun’s Computational Geo-Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//data/_quarto/favicon/geography-icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-befe23ebd2f54d8af2c8a89d1a1611f1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d3b1631f4722382dd39bbee6576dd6ee.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-301f078a9ada584aacf72e3abf6cdb20.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-d3b1631f4722382dd39bbee6576dd6ee.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>
//https://jihongzhang.org/posts/2023-06-26-moving-to-quarto/
function getGiscusTheme() {
  const quartoTheme = localStorage.getItem("quarto-color-scheme");
  const giscusTheme = quartoTheme === "alternate" ? "dark" : "light";
  return giscusTheme;
}

function setGiscusTheme() {
  function sendMessage(message) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }
  sendMessage({
    setConfig: {
      theme: getGiscusTheme(),
    },
  });
}

document.addEventListener('DOMContentLoaded', function () {
  const giscusAttributes = {
    "src": "https://giscus.app/client.js",
    "data-repo": "YONGHUNI/blog",
    "data-repo-id": "R_kgDOM8VPhg",
    "data-category": "General",
    "data-category-id": "DIC_kwDOM8VPhs4CjHhk",
    "data-mapping": "title",
    "data-strict": "0",
    "data-reactions-enabled": "1",
    "data-emit-metadata": "1",
    "data-input-position": "top",
    "data-theme": getGiscusTheme(),
    "data-lang": "en",
    "crossorigin": "anonymous",
    "async": "",
  };

  // Dynamically create script tag
  const giscusScript = document.createElement("script");
  Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
  document.body.appendChild(giscusScript);

  // Update giscus theme when theme switcher is clicked
  const toggle = document.querySelector('.quarto-color-scheme-toggle');
  if (toggle) {
    toggle.addEventListener('click', setGiscusTheme);
  }
});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../misc/styles.css">
</head>
<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Yonghun’s Computational Geo-Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../#category=news"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../#category=Code"> 
<span class="menu-text">Code</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../#category=Research"> 
<span class="menu-text">Research</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">About</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-about">
<li>
    <a class="dropdown-item" href="../../about/me/index.html">
 <span class="dropdown-text">Me</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../about/blog/index.html">
 <span class="dropdown-text">This Blog</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0009-0003-6800-2731" target="_blank"> 
<span class="menu-text"><i class="ai  ai-orcid"></i></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/YONGHUNI" target="_blank">
 <span class="dropdown-text">My Profile</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/YONGHUNI/blog" target="_blank">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">How to boost a DBSCAN task</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Utilizing High Performance Library from Python</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Code</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yonghun Suh </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 9, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#backdrop" id="toc-backdrop" class="nav-link active" data-scroll-target="#backdrop"><span class="header-section-number">1</span> Backdrop</a>
  <ul class="collapse">
<li><a href="#analyzing-complexity-factors" id="toc-analyzing-complexity-factors" class="nav-link" data-scroll-target="#analyzing-complexity-factors"><span class="header-section-number">1.1</span> <strong>Analyzing complexity factors</strong></a></li>
  <li>
<a href="#dbscan-time-complexity" id="toc-dbscan-time-complexity" class="nav-link" data-scroll-target="#dbscan-time-complexity"><span class="header-section-number">1.2</span> DBSCAN time complexity</a>
  <ul class="collapse">
<li><a href="#core-steps-and-cost-drivers" id="toc-core-steps-and-cost-drivers" class="nav-link" data-scroll-target="#core-steps-and-cost-drivers"><span class="header-section-number">1.2.1</span> Core steps and cost drivers</a></li>
  <li><a href="#complexity-by-neighborhood-search-strategy" id="toc-complexity-by-neighborhood-search-strategy" class="nav-link" data-scroll-target="#complexity-by-neighborhood-search-strategy"><span class="header-section-number">1.2.2</span> Complexity by neighborhood search strategy</a></li>
  </ul>
</li>
  <li><a href="#what-influences-the-runtime" id="toc-what-influences-the-runtime" class="nav-link" data-scroll-target="#what-influences-the-runtime"><span class="header-section-number">1.3</span> What influences the runtime</a></li>
  <li><a href="#practical-scenarios" id="toc-practical-scenarios" class="nav-link" data-scroll-target="#practical-scenarios"><span class="header-section-number">1.4</span> Practical scenarios</a></li>
  <li><a href="#solution-at-least-for-this-case" id="toc-solution-at-least-for-this-case" class="nav-link" data-scroll-target="#solution-at-least-for-this-case"><span class="header-section-number">1.5</span> Solution…? At least for this case :)</a></li>
  </ul>
</li>
  <li>
<a href="#experiments" id="toc-experiments" class="nav-link" data-scroll-target="#experiments"><span class="header-section-number">2</span> Experiments</a>
  <ul class="collapse">
<li>
<a href="#setups" id="toc-setups" class="nav-link" data-scroll-target="#setups"><span class="header-section-number">2.1</span> Setups</a>
  <ul class="collapse">
<li><a href="#used-r-packages" id="toc-used-r-packages" class="nav-link" data-scroll-target="#used-r-packages"><span class="header-section-number">2.1.1</span> Used R Packages</a></li>
  <li><a href="#python-setup" id="toc-python-setup" class="nav-link" data-scroll-target="#python-setup"><span class="header-section-number">2.1.2</span> Python Setup</a></li>
  </ul>
</li>
  <li>
<a href="#generated-lab-dataset" id="toc-generated-lab-dataset" class="nav-link" data-scroll-target="#generated-lab-dataset"><span class="header-section-number">2.2</span> Generated Lab Dataset</a>
  <ul class="collapse">
<li><a href="#r---naive" id="toc-r---naive" class="nav-link" data-scroll-target="#r---naive"><span class="header-section-number">2.2.1</span> R - Naive</a></li>
  <li><a href="#python---wangyiqiudbscan-python" id="toc-python---wangyiqiudbscan-python" class="nav-link" data-scroll-target="#python---wangyiqiudbscan-python"><span class="header-section-number">2.2.2</span> Python - <code>wangyiqiu/dbscan-python</code></a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">2.2.3</span> Results</a></li>
  </ul>
</li>
  <li>
<a href="#some-real-world-dataset" id="toc-some-real-world-dataset" class="nav-link" data-scroll-target="#some-real-world-dataset"><span class="header-section-number">2.3</span> Some Real World Dataset</a>
  <ul class="collapse">
<li><a href="#r---naive-1" id="toc-r---naive-1" class="nav-link" data-scroll-target="#r---naive-1"><span class="header-section-number">2.3.1</span> R - Naive</a></li>
  <li><a href="#python---wangyiqiudbscan-python-1" id="toc-python---wangyiqiudbscan-python-1" class="nav-link" data-scroll-target="#python---wangyiqiudbscan-python-1"><span class="header-section-number">2.3.2</span> Python - <code>wangyiqiu/dbscan-python</code></a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1"><span class="header-section-number">2.3.3</span> Results</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#take-home-message" id="toc-take-home-message" class="nav-link" data-scroll-target="#take-home-message"><span class="header-section-number">3</span> Take-home message</a></li>
  <li><a href="#environment-info" id="toc-environment-info" class="nav-link" data-scroll-target="#environment-info"><span class="header-section-number">4</span> Environment info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="backdrop" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Backdrop</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="data/background.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Chat"><img src="data/background.jpg" class="img-fluid figure-img" style="width:70.0%" alt="Chat"></a></p>
<figcaption>Chat</figcaption></figure>
</div>
<blockquote class="blockquote">
<p>[Frodo, 2:37 PM] I’m working on finding representative points for census tracts using nationwide residential building data, weighted by the population of each tract.<br> [Frodo, 2:38 PM] But DBSCAN is taking forever lol, so I’m running it in parallel.<br> [Frodo, 2:38 PM] Using something like the future package in R.<br> [Yong-Hun Suh, 2:41 PM] Yeah, DBSCAN’s time complexity isn’t great…<br> [Yong-Hun Suh, 4:47 PM] Are you still working on that (DBSCAN)?<br> [Yong-Hun Suh, 4:47 PM] If it’s a project you’re going to continue, I can give you a tip…<br> [Frodo, 4:53 PM] Just fixed the code and running it now haha, results should come out in a <strong>few days</strong> if it’s fast.<br></p>
</blockquote>
<p>I was chatting with my colleague from grad school who said DBSCAN was running too slowly on their project.</p>
<p>He had already been using a high speed C++ implementation of DBSCAN in R. Still, however, it was giving eternal waiting.</p>
<p>I thought, ‘Why not help him out and turn this into a blog article?’</p>
<section id="analyzing-complexity-factors" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="analyzing-complexity-factors">
<span class="header-section-number">1.1</span> <strong>Analyzing complexity factors</strong>
</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is Time Complexity?
</div>
</div>
<div class="callout-body-container callout-body">
<p>In theoretical computer science, the time complexity is the computational complexity that describes the amount of computer time it takes to run an algorithm. In the plot below, <span class="math inline">\(n\)</span> represents the size of the input, and <span class="math inline">\(N\)</span> represents the number of operations the algorithm performs. This relationship is a critical factor in defining the algorithm’s performance, as the efficiency of the algorithm can be assessed by how <span class="math inline">\(N\)</span> changes as the input size <span class="math inline">\(n\)</span> increases.</p>
<p><a href="https://en.wikipedia.org/wiki/Time_complexity" target="_blank">Learn more</a></p>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Seq `n` gen</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>  <span class="co"># need to make the increment small in order to avoid `Inf`s</span></span>
<span></span>
<span><span class="co"># data.table</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span></span>
<span>                  n <span class="op">=</span> <span class="va">n</span>,</span>
<span>                  `O(1)` <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  `O(log n)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>                  `O(n)` <span class="op">=</span> <span class="va">n</span>,</span>
<span>                  `O(n log n)` <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>                  `O(n^2)` <span class="op">=</span> <span class="va">n</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>                  `O(2^n)` <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="va">n</span>,</span>
<span>                  `O(n!)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>                <span class="op">)</span></span>
<span></span>
<span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span><span class="va">df</span>, id.vars <span class="op">=</span> <span class="st">"n"</span>, variable.name <span class="op">=</span> <span class="st">"Complexity"</span>, value.name <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">Time</span>, color <span class="op">=</span> <span class="va">Complexity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>            <span class="co">#title = "Compirison of Computational Complexity",</span></span>
<span>            x <span class="op">=</span> <span class="st">"Input Size (n)"</span>,</span>
<span>            y <span class="op">=</span> <span class="st">"Number of Operations (N)"</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"Complexity"</span></span>
<span>          <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>            plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>            legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>            legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="It is good to know if the algorithm can handle my problem well!"><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" alt="A line plot of Computational Complexity" width="672"></a></p>
<figcaption>It is good to know if the algorithm can handle my problem well!</figcaption></figure>
</div>
</div>
<p>Compirison of Computational Complexity</p>
</div>
</section><section id="dbscan-time-complexity" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="dbscan-time-complexity">
<span class="header-section-number">1.2</span> DBSCAN time complexity</h2>
<p>DBSCAN’s runtime is dominated by how you perform neighborhood (range) queries. The classic “it’s <span class="math inline">\(O(n²)\)</span>” is only the worst case of a spectrum that depends on data distribution, dimensionality, the index used, and the radius parameter <span class="math inline">\(\varepsilon\)</span>.</p>
<hr>
<section id="core-steps-and-cost-drivers" class="level3" data-number="1.2.1"><h3 data-number="1.2.1" class="anchored" data-anchor-id="core-steps-and-cost-drivers">
<span class="header-section-number">1.2.1</span> Core steps and cost drivers</h3>
<ul>
<li>
<strong>Range queries:</strong> For each point, find all neighbors within radius <span class="math inline">\(\varepsilon\)</span>. Distance evaluation for one pair costs <span class="math inline">\(O(d)\)</span> in <span class="math inline">\(d\)</span>-dimensional Euclidean space.</li>
<li>
<strong>Cluster expansion:</strong> A queue-based flood-fill that repeatedly issues range queries starting from core points (points with at least <span class="math inline">\(\text{minPts}\)</span> neighbors within <span class="math inline">\(\varepsilon\)</span>).</li>
</ul>
<p>Asymptotically, the number and cost of range queries dominate; the expansion logic is linear in the number of discovered neighbors but tied to the same range-query results.</p>
<hr></section><section id="complexity-by-neighborhood-search-strategy" class="level3" data-number="1.2.2"><h3 data-number="1.2.2" class="anchored" data-anchor-id="complexity-by-neighborhood-search-strategy">
<span class="header-section-number">1.2.2</span> Complexity by neighborhood search strategy</h3>
<section id="brute-force-no-index" class="level4" data-number="1.2.2.1"><h4 data-number="1.2.2.1" class="anchored" data-anchor-id="brute-force-no-index">
<span class="header-section-number">1.2.2.1</span> Brute-force (no index)</h4>
<ul>
<li>Per range query: compute distance to all points ⇒ <span class="math inline">\(O(n \cdot d)\)</span>.</li>
<li>One query per point in the simplest implementation ⇒ <span class="math inline">\(O(n^2 \cdot d)\)</span>.</li>
<li>Cluster expansion may reuse queries or cause repeats; asymptotically the bound remains <span class="math inline">\(\Theta(n^2 \cdot d)\)</span> in the worst case.</li>
</ul></section><section id="space-partitioning-trees-kd-tree-ball-tree-r-tree-like" class="level4" data-number="1.2.2.2"><h4 data-number="1.2.2.2" class="anchored" data-anchor-id="space-partitioning-trees-kd-tree-ball-tree-r-tree-like">
<span class="header-section-number">1.2.2.2</span> Space-partitioning trees (kd-tree, ball tree, R-tree-like)</h4>
<ul>
<li>Index build: typically <span class="math inline">\(O(n \log n)\)</span> time, <span class="math inline">\(O(n)\)</span> space.</li>
<li>Range query cost:
<ul>
<li>Best/average (well-behaved low–moderate <span class="math inline">\(d\)</span>, balanced tree, moderate <span class="math inline">\(\varepsilon\)</span>): <span class="math inline">\(O(\log n + k)\)</span>, where <span class="math inline">\(k\)</span> is the number of reported neighbors.</li>
<li>Worst case (high <span class="math inline">\(d\)</span>, large <span class="math inline">\(\varepsilon\)</span>, or adversarial data): degenerates to <span class="math inline">\(O(n)\)</span>.</li>
</ul>
</li>
<li>Overall:
<ul>
<li>Best/average: <span class="math inline">\(O(n \log n + \sum \limits_{i=1}^{n} (\log n + k_i)) = O(n \log n + K)\)</span>, where <span class="math inline">\(K = \sum k_i\)</span> is total neighbor reports. If density per query is bounded, <span class="math inline">\(K = O(n)\)</span>, giving <span class="math inline">\(O(n \log n)\)</span> plus distance cost factor <span class="math inline">\(O(d)\)</span>.</li>
<li>Worst: <span class="math inline">\(O(n^2 \cdot d)\)</span>.</li>
</ul>
</li>
</ul></section><section id="uniform-grid-fixed-radius-hashing-in-low-dimensions" class="level4" data-number="1.2.2.3"><h4 data-number="1.2.2.3" class="anchored" data-anchor-id="uniform-grid-fixed-radius-hashing-in-low-dimensions">
<span class="header-section-number">1.2.2.3</span> Uniform grid (fixed-radius hashing) in low dimensions</h4>
<ul>
<li>Build grid hashing once: expected <span class="math inline">\(O(n)\)</span>.</li>
<li>Range query: constant number of adjacent cells, expected <span class="math inline">\(O(1 + k)\)</span> in 2D/3D if <span class="math inline">\(\varepsilon\)</span> is aligned with cell size and data are not pathologically skewed.</li>
<li>Overall in practice: near-linear <span class="math inline">\(O(n + K)\)</span>, again with distance cost <span class="math inline">\(O(d)\)</span>, but this approach becomes brittle as <span class="math inline">\(d\)</span> grows.</li>
</ul>
<blockquote class="blockquote">
<p>In all cases, include the distance computation factor <span class="math inline">\(O(d)\)</span>. For high dimensions, tree and grid pruning effectiveness collapses, pushing complexity toward <span class="math inline">\(\Theta(n^2 \cdot d)\)</span>.</p>
</blockquote>
<hr></section></section></section><section id="what-influences-the-runtime" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="what-influences-the-runtime">
<span class="header-section-number">1.3</span> What influences the runtime</h2>
<ul>
<li>
<strong>Dimensionality <span class="math inline">\(d\)</span>:</strong> Distance costs scale with <span class="math inline">\(O(d)\)</span>, and index pruning degrades with the curse of dimensionality, often turning tree queries into <span class="math inline">\(O(n)\)</span>.</li>
<li>
<strong>Neighborhood radius <span class="math inline">\(\varepsilon\)</span>:</strong> Larger <span class="math inline">\(\varepsilon\)</span> increases average neighbor count <span class="math inline">\(k\)</span>, raises <span class="math inline">\(K=\sum k_i\)</span>, and triggers more expansions; in the limit, most points neighbor each other ⇒ near <span class="math inline">\(O(n^2 \cdot d)\)</span>.</li>
<li>
<strong>Data distribution and density:</strong> Well-separated, roughly uniform, low-density data favor subquadratic performance with indexes. Dense clusters or large connected components increase expansions and repeats.</li>
<li>
<strong>minPts:</strong> Affects how many points become core (thus how much expansion occurs). It changes constants and practical behavior but not the worst-case big-O bound.</li>
<li>
<strong>Distance metric:</strong> Non-Euclidean metrics can alter pruning efficacy and per-distance cost.</li>
<li>
<strong>Implementation details:</strong> Caching of range queries, deduplication, and “expand only once per point” optimizations materially reduce constants.</li>
</ul>
<hr></section><section id="practical-scenarios" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="practical-scenarios">
<span class="header-section-number">1.4</span> Practical scenarios</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header">
<th>Scenario</th>
<th>Assumptions</th>
<th>Typical complexity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Brute-force baseline</td>
<td>Any <span class="math inline">\(d\)</span>, no index</td>
<td><span class="math inline">\(\Theta(n^2 \cdot d)\)</span></td>
</tr>
<tr class="even">
<td>Tree index, low–moderate <span class="math inline">\(d\)</span>
</td>
<td>Balanced tree, moderate <span class="math inline">\(\varepsilon\)</span>, bounded neighbor counts</td>
<td><span class="math inline">\(O(n \log n \cdot d)\)</span></td>
</tr>
<tr class="odd">
<td>Tree index, high <span class="math inline">\(d\)</span> or large <span class="math inline">\(\varepsilon\)</span>
</td>
<td>Poor pruning, dense neighborhoods</td>
<td><span class="math inline">\(\Theta(n^2 \cdot d)\)</span></td>
</tr>
<tr class="even">
<td>Grid index (2D/3D)</td>
<td>Well-chosen cell size, non-pathological data</td>
<td>Near <span class="math inline">\(O(n \cdot d)\)</span>
</td>
</tr>
<tr class="odd">
<td>Approximate NN/range</td>
<td>ANN structure (e.g., HNSW), approximate neighbors</td>
<td>Subquadratic wall-time; formal bounds vary</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The index build cost <span class="math inline">\(O(n \log n)\)</span> (trees) or <span class="math inline">\(O(n)\)</span> (grid) is typically amortized across all range queries.</li>
<li>If each point’s neighbor count <span class="math inline">\(k_i\)</span> is bounded by a small constant on average, and pruning works, the total neighbor reports <span class="math inline">\(K\)</span> is <span class="math inline">\(O(n)\)</span>, leading to near <span class="math inline">\(O(n \log n)\)</span> behavior with trees.</li>
</ul>
</div>
</div>
<blockquote class="blockquote">
<p>But… What if you neither can reduce your dataset… nor change the parameter of the DBSCAN?</p>
</blockquote>
</section><section id="solution-at-least-for-this-case" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="solution-at-least-for-this-case">
<span class="header-section-number">1.5</span> Solution…? At least for this case :)</h2>
<p><strong>Use more efficient algorithms that fully leverage your hardware’s full potential!</strong></p>
<p>For this case, I used <code>dbscan-python</code>, which is a high-performance parallel implementation of DBSCAN, based on the SIGMOD 2020 paper “<a href="https://github.com/wangyiqiu/dbscan-python" target="_blank">Theoretically Efficient and Practical Parallel DBSCAN</a>.”</p>
<p>This work achieves theoretically-efficient clustering by minimizing total work and maintaining polylogarithmic parallel depth, enabling scalable performance on large datasets.</p>
<p>Compared to the naive <span class="math inline">\(O(n^2)\)</span> approach, the proposed algorithm reduces time complexity to <span class="math inline">\(O(n \log n)\)</span> work and <span class="math inline">\(O(\log n)\)</span> depth in 2D, and sub-quadratic work in higher dimensions through grid-based partitioning, parallel union-find, and spatial indexing techniques.</p>
<p>As the name of the package implies, I need to use Python again for this experiment.</p>
</section></section><section id="experiments" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Experiments</h1>
<section id="setups" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="setups">
<span class="header-section-number">2.1</span> Setups</h2>
<section id="used-r-packages" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="used-r-packages">
<span class="header-section-number">2.1.1</span> Used R Packages</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/dbscan">dbscan</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dbscan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    as.dendrogram</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/">arrow</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'arrow'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    timestamp</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org">future.apply</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: future</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="python-setup" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="python-setup">
<span class="header-section-number">2.1.2</span> Python Setup</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="st">"Windows"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        </span>
<span>    <span class="co"># For my Windows Environment</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"C:/Users/dydgn/miniforge3/envs/dbscan/python.exe"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"micromamba install -n baseline -c conda-forge dbscan -y"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># For github actions to utilize CI/CD</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html">use_condaenv</a></span><span class="op">(</span><span class="st">"/home/runner/micromamba/envs/baseline/bin/python"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   </span>
<span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op">(</span><span class="st">"sys"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sys</span><span class="op">$</span><span class="va">executable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "/home/runner/micromamba/envs/baseline/bin/python"</code></pre>
</div>
</div>
</section></section><section id="generated-lab-dataset" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="generated-lab-dataset">
<span class="header-section-number">2.2</span> Generated Lab Dataset</h2>
<p>First, I had to replicate a famous dataset for demonstrating DBSCAN.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">generate_random_semicircle</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">center_x</span>, <span class="va">center_y</span>, <span class="va">radius</span>, <span class="va">start_angle</span>, <span class="va">end_angle</span>, <span class="va">n_points</span> <span class="op">=</span> <span class="fl">100</span>, <span class="va">noise</span> <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">angles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_points</span>, min <span class="op">=</span> <span class="va">start_angle</span>, max <span class="op">=</span> <span class="va">end_angle</span><span class="op">)</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">center_x</span> <span class="op">+</span> <span class="va">radius</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">angles</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_points</span>, <span class="fl">0</span>, <span class="va">noise</span><span class="op">)</span></span>
<span>      <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">center_y</span> <span class="op">+</span> <span class="va">radius</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">angles</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_points</span>, <span class="fl">0</span>, <span class="va">noise</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1e+5L</span></span>
<span></span>
<span></span>
<span><span class="va">semicircle1</span> <span class="op">&lt;-</span> <span class="fu">generate_random_semicircle</span><span class="op">(</span>center_x <span class="op">=</span> <span class="fl">0</span>, center_y <span class="op">=</span> <span class="fl">0.25</span>, radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                          start_angle <span class="op">=</span> <span class="va">pi</span>, end_angle <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span>, n_points <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">semicircle1</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"Semicircle 1"</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">semicircle2</span> <span class="op">&lt;-</span> <span class="fu">generate_random_semicircle</span><span class="op">(</span>center_x <span class="op">=</span> <span class="fl">1</span>, center_y <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span>, radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                          start_angle <span class="op">=</span> <span class="fl">0</span>, end_angle <span class="op">=</span> <span class="va">pi</span>, n_points <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">semicircle2</span><span class="op">[</span>, <span class="va">group</span> <span class="op">:=</span> <span class="st">"Semicircle 2"</span><span class="op">]</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">semicircle1</span>, <span class="va">semicircle2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># visualization</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Randomized Overlapping Semicircles"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lab_data</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>, with <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="r---naive" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="r---naive">
<span class="header-section-number">2.2.1</span> R - Naive</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lab_data_r</span> <span class="op">&lt;-</span> <span class="va">lab_data</span></span>
<span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span>  <span class="fl">.08</span></span>
<span><span class="va">minpts</span> <span class="op">&lt;-</span> <span class="fl">200L</span> <span class="co">#should be an integer for the python env</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">stime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">db_result_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html">dbscan</a></span><span class="op">(</span><span class="va">lab_data_r</span>, eps <span class="op">=</span> <span class="va">epsilon</span>, minPts <span class="op">=</span> <span class="va">minpts</span><span class="op">)</span></span>
<span><span class="va">etime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">delta_t_r</span> <span class="op">&lt;-</span> <span class="va">etime</span><span class="op">-</span><span class="va">stime</span>; <span class="va">delta_t_r</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Time difference of 9.106071 secs</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">db_result_r</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    0     1     2 
  143 99925 99932 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lab_data_r</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">db_result_r</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualization</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">lab_data_r</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Randomized Overlapping Semicircles"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="python---wangyiqiudbscan-python" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="python---wangyiqiudbscan-python">
<span class="header-section-number">2.2.2</span> Python - <code>wangyiqiu/dbscan-python</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lab_data_py</span> <span class="op">&lt;-</span> <span class="va">lab_data</span></span>
<span></span>
<span><span class="va">py</span><span class="op">$</span><span class="va">lab_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">lab_data_py</span><span class="op">)</span></span>
<span><span class="va">py</span><span class="op">$</span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="va">epsilon</span></span>
<span><span class="va">py</span><span class="op">$</span><span class="va">minpts</span> <span class="op">&lt;-</span> <span class="va">minpts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dbscan <span class="im">import</span> DBSCAN</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"type(X):"</span>, <span class="bu">type</span>(lab_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>type(X): &lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape(X):"</span>, <span class="bu">getattr</span>(lab_data, <span class="st">'shape'</span>, <span class="va">None</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>shape(X): (200000, 2)</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time.time()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>labels, core_samples_mask <span class="op">=</span> DBSCAN(lab_data, eps <span class="op">=</span> epsilon, min_samples <span class="op">=</span> minpts)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> time.time()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>delta_t <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Elapsed time: </span><span class="sc">{</span>delta_t<span class="sc">:.4f}</span><span class="ss"> seconds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Elapsed time: 0.0556 seconds</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과를 R로 반환</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#r.labels = labels</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#r.core_mask = core_samples_mask</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">py</span><span class="op">$</span><span class="va">labels</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   -1     0     1 
  143 99925 99932 </code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lab_data_py</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">py</span><span class="op">$</span><span class="va">labels</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co"># as index number starts from 0</span></span>
<span></span>
<span><span class="co"># visualization</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">lab_data_py</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Randomized Overlapping Semicircles"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="results" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="results">
<span class="header-section-number">2.2.3</span> Results</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#speedup</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">delta_t_r</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">/</span><span class="va">py</span><span class="op">$</span><span class="va">delta_t</span>,<span class="st">" times speed-up\n"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>163.6599 times speed-up</code></pre>
</div>
</div>
</section></section><section id="some-real-world-dataset" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="some-real-world-dataset">
<span class="header-section-number">2.3</span> Some Real World Dataset</h2>
<p>Source: <a href="https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page">NYC Taxi Data</a></p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">months</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">urls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">months</span><span class="op">)</span>,<span class="st">".parquet"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span>,workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">taxi_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html">future_lapply</a></span><span class="op">(</span><span class="va">urls</span>, <span class="kw">function</span><span class="op">(</span><span class="va">url</span><span class="op">)</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html">read_parquet</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger  (Mb)  max used  (Mb)
Ncells  2684117 143.4    4872675 260.3   3819024 204.0
Vcells 55665873 424.7  104465142 797.1 103119429 786.8</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">taxi_list</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   VendorID tpep_pickup_datetime tpep_dropoff_datetime passenger_count
      &lt;int&gt;               &lt;POSc&gt;                &lt;POSc&gt;           &lt;int&gt;
1:        2  2024-01-01 00:57:55   2024-01-01 01:17:43               1
2:        1  2024-01-01 00:03:00   2024-01-01 00:09:36               1
3:        1  2024-01-01 00:17:06   2024-01-01 00:35:01               1
4:        1  2024-01-01 00:36:38   2024-01-01 00:44:56               1
5:        1  2024-01-01 00:46:51   2024-01-01 00:52:57               1
6:        1  2024-01-01 00:54:08   2024-01-01 01:26:31               1
   trip_distance RatecodeID store_and_fwd_flag PULocationID DOLocationID
           &lt;num&gt;      &lt;int&gt;             &lt;char&gt;        &lt;int&gt;        &lt;int&gt;
1:          1.72          1                  N          186           79
2:          1.80          1                  N          140          236
3:          4.70          1                  N          236           79
4:          1.40          1                  N           79          211
5:          0.80          1                  N          211          148
6:          4.70          1                  N          148          141
   payment_type fare_amount extra mta_tax tip_amount tolls_amount
          &lt;int&gt;       &lt;num&gt; &lt;num&gt;   &lt;num&gt;      &lt;num&gt;        &lt;num&gt;
1:            2        17.7   1.0     0.5       0.00            0
2:            1        10.0   3.5     0.5       3.75            0
3:            1        23.3   3.5     0.5       3.00            0
4:            1        10.0   3.5     0.5       2.00            0
5:            1         7.9   3.5     0.5       3.20            0
6:            1        29.6   3.5     0.5       6.90            0
   improvement_surcharge total_amount congestion_surcharge Airport_fee
                   &lt;num&gt;        &lt;num&gt;                &lt;num&gt;       &lt;num&gt;
1:                     1        22.70                  2.5           0
2:                     1        18.75                  2.5           0
3:                     1        31.30                  2.5           0
4:                     1        17.00                  2.5           0
5:                     1        16.10                  2.5           0
6:                     1        41.50                  2.5           0</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># select numeric rows &amp; filtering out NAs</span></span>
<span><span class="va">taxi_numeric_dt</span> <span class="op">&lt;-</span> <span class="va">taxi_list</span><span class="op">[</span></span>
<span>    <span class="va">trip_distance</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">fare_amount</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">trip_distance</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">fare_amount</span><span class="op">)</span>,</span>
<span>    <span class="fu">.</span><span class="op">(</span><span class="va">trip_distance</span>, <span class="va">fare_amount</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">taxi_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger  (Mb)  max used  (Mb)
Ncells  2690701 143.7    4872675 260.3   3819024 204.0
Vcells 13999634 106.9   83572114 637.7 103119429 786.8</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taxi_numeric_dt_200k</span> <span class="op">&lt;-</span> <span class="va">taxi_numeric_dt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">.N</span>, <span class="fl">200000</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#taxi_numeric_dt_10m &lt;- taxi_numeric_dt[sample(.N, 10000000)]</span></span>
<span></span>
<span></span>
<span><span class="va">py</span><span class="op">$</span><span class="va">taxi_numeric_dt_200k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">taxi_numeric_dt_200k</span><span class="op">)</span></span>
<span><span class="co">#py$taxi_numeric_dt_10m &lt;- as.matrix(taxi_numeric_dt_10m)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="r---naive-1" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="r---naive-1">
<span class="header-section-number">2.3.1</span> R - Naive</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">epsilon</span> <span class="op">&lt;-</span>  <span class="fl">0.3</span></span>
<span><span class="va">minpts</span> <span class="op">&lt;-</span> <span class="fl">10L</span></span>
<span></span>
<span></span>
<span><span class="va">stime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">db_result_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html">dbscan</a></span><span class="op">(</span><span class="va">taxi_numeric_dt_200k</span>, eps <span class="op">=</span> <span class="va">epsilon</span>, minPts <span class="op">=</span> <span class="va">minpts</span><span class="op">)</span></span>
<span><span class="va">etime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">delta_t_r</span> <span class="op">&lt;-</span> <span class="va">etime</span><span class="op">-</span><span class="va">stime</span>; <span class="va">delta_t_r</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Time difference of 11.63554 secs</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">db_result_r</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
     0      1      2      3      4      5      6      7      8      9     10 
  4389 163774   6336   4349     79     24   1035   6355    206   1185   2048 
    11     12     13     14     15     16     17     18     19     20     21 
  1503   1218    270    301    617    893    311    106    145    313    247 
    22     23     24     25     26     27     28     29     30     31     32 
   244    161     74     70    224    205    155    155    437    137    449 
    33     34     35     36     37     38     39     40     41     42     43 
    39    135     68     76    164     29    167     37     39    118     40 
    44     45     46     47     48     49     50     51     52     53     54 
    27     39     18     17     16    142     49     72     44     19     11 
    55     56     57     58     59     60     61     62     63     64     65 
    15      7     14     32     14     31     11     10     21     31     12 
    66     67     68     69     70     71     72     73     74     75     76 
    11     18     24     20     30     12     11     20     10     33     14 
    77     78     79     80     81     82     83     84     85     86     87 
    10     13      9     10     11     16     11     12      9     10      7 
    88     89     90     91     92     93     94     95     96     97     98 
    10     10     10      3     10     10      7     10     10     10     10 </code></pre>
</div>
</div>
</section><section id="python---wangyiqiudbscan-python-1" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="python---wangyiqiudbscan-python-1">
<span class="header-section-number">2.3.2</span> Python - <code>wangyiqiu/dbscan-python</code>
</h3>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">py</span><span class="op">$</span><span class="va">taxi_numeric_dt_200k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">taxi_numeric_dt_200k</span><span class="op">)</span></span>
<span><span class="va">py</span><span class="op">$</span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="va">epsilon</span></span>
<span><span class="va">py</span><span class="op">$</span><span class="va">minpts</span> <span class="op">&lt;-</span> <span class="va">minpts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dbscan <span class="im">import</span> DBSCAN</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"type(X):"</span>, <span class="bu">type</span>(taxi_numeric_dt_200k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>type(X): &lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape(X):"</span>, <span class="bu">getattr</span>(taxi_numeric_dt_200k, <span class="st">'shape'</span>, <span class="va">None</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>shape(X): (200000, 2)</code></pre>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time.time()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>labels, core_samples_mask <span class="op">=</span> DBSCAN(taxi_numeric_dt_200k, eps<span class="op">=</span><span class="fl">0.3</span>, min_samples<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> time.time()</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>delta_t <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Elapsed time: </span><span class="sc">{</span>delta_t<span class="sc">:.4f}</span><span class="ss"> seconds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Elapsed time: 0.0376 seconds</code></pre>
</div>
</div>
</section><section id="results-1" class="level3" data-number="2.3.3"><h3 data-number="2.3.3" class="anchored" data-anchor-id="results-1">
<span class="header-section-number">2.3.3</span> Results</h3>
<p>The code below shows the results are valid, as it counts how many rows are assigned to each label, sorts the counts in ascending order, and returns the difference between the two label distributions.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">py</span><span class="op">$</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">db_result_r</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1]  3  0  1  3  1  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  1
[26]  1  0  0  1  0  0  0  0  0  0  0  0 -1  0 -1  0  0  0  0  0  1  0  0  0  0
[51]  1  0  0  0  0  0  0  0  0  0  0  0  0 -1 -2  0  0  0  0  0  0  0  0  0  0
[76] -3  0  0  0  0  0  0  0  0  0 -1  0  0  0 -2  3  0 -2  0  0  0  0  0 -6</code></pre>
</div>
</div>
<p>A slight difference is observed. but it appears to stem from floating-point or grid based operations, hence it is negligible.</p>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#speedup</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">delta_t_r</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">/</span><span class="va">py</span><span class="op">$</span><span class="va">delta_t</span>,<span class="st">" times speed-up\n"</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>309.3261 times speed-up</code></pre>
</div>
</div>
<p>What a whopping improvement isn’t it?</p>
</section></section></section><section id="take-home-message" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Take-home message</h1>
<div class="callout callout-style-default callout-tip callout-titled" title="DBSCAN is a slow algorithm">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
DBSCAN is a slow algorithm
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Worst-case time: <span class="math inline">\(\Theta(n^2 \cdot d)\)</span> regardless of indexing.</li>
<li>Well-behaved low-dimensional data with effective indexing can approach <span class="math inline">\(O(n \log n \cdot d)\)</span>.</li>
<li>As <span class="math inline">\(d\)</span> or <span class="math inline">\(\varepsilon\)</span> grow, expect degradation toward quadratic behavior.</li>
<li>Tuning <span class="math inline">\(\varepsilon\)</span>, choosing appropriate indexes, and reducing <span class="math inline">\(d\)</span> (e.g., via PCA) often matter more than micro-optimizations.</li>
<li>If you cannot apply the above strategies, <strong>use a high-performance implementation</strong>.</li>
</ul>
</div>
</div>
</section><section id="environment-info" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Environment info</h1>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.0 (2025-04-11)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] reticulate_1.43.0   future.apply_1.20.0 future_1.67.0      
[4] arrow_21.0.0.1      dbscan_1.2.3        ggplot2_3.5.2      
[7] data.table_1.17.8  

loaded via a namespace (and not attached):
 [1] Matrix_1.7-3       bit_4.6.0          gtable_0.3.6       jsonlite_2.0.0    
 [5] dplyr_1.1.4        compiler_4.5.0     renv_1.1.5         tidyselect_1.2.1  
 [9] Rcpp_1.1.0         parallel_4.5.0     assertthat_0.2.1   png_0.1-8         
[13] globals_0.18.0     scales_1.4.0       yaml_2.3.10        fastmap_1.2.0     
[17] lattice_0.22-7     R6_2.6.1           labeling_0.4.3     generics_0.1.4    
[21] knitr_1.50         htmlwidgets_1.6.4  tibble_3.3.0       pillar_1.11.0     
[25] RColorBrewer_1.1-3 rlang_1.1.6        xfun_0.52          bit64_4.6.0-1     
[29] cli_3.6.5          withr_3.0.2        magrittr_2.0.3     digest_0.6.37     
[33] grid_4.5.0         lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.4    
[37] glue_1.8.0         listenv_0.9.1      farver_2.1.2       codetools_0.2-20  
[41] parallelly_1.45.1  rmarkdown_2.29     purrr_1.1.0        tools_4.5.0       
[45] pkgconfig_2.0.3    htmltools_0.5.8.1 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="st">"Windows"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        </span>
<span>    <span class="co"># For my Windows Environment</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"systeminfo"</span>,intern <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"lscpu; free -h"</span>,intern <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span>    </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "Architecture:                         x86_64"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 [2] "CPU op-mode(s):                       32-bit, 64-bit"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 [3] "Address sizes:                        48 bits physical, 48 bits virtual"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 [4] "Byte Order:                           Little Endian"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 [5] "CPU(s):                               4"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
 [6] "On-line CPU(s) list:                  0-3"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 [7] "Vendor ID:                            AuthenticAMD"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 [8] "Model name:                           AMD EPYC 7763 64-Core Processor"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
 [9] "CPU family:                           25"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
[10] "Model:                                1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
[11] "Thread(s) per core:                   2"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
[12] "Core(s) per socket:                   2"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
[13] "Socket(s):                            1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
[14] "Stepping:                             1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
[15] "BogoMIPS:                             4890.86"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
[16] "Flags:                                fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl tsc_reliable nonstop_tsc cpuid extd_apicid aperfmperf tsc_known_freq pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext vmmcall fsgsbase bmi1 avx2 smep bmi2 erms invpcid rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 xsaves user_shstk clzero xsaveerptr rdpru arat npt nrip_save tsc_scale vmcb_clean flushbyasid decodeassists pausefilter pfthreshold v_vmsave_vmload umip vaes vpclmulqdq rdpid fsrm"
[17] "Virtualization:                       AMD-V"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
[18] "Hypervisor vendor:                    Microsoft"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
[19] "Virtualization type:                  full"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[20] "L1d cache:                            64 KiB (2 instances)"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[21] "L1i cache:                            64 KiB (2 instances)"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[22] "L2 cache:                             1 MiB (2 instances)"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
[23] "L3 cache:                             32 MiB (1 instance)"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
[24] "NUMA node(s):                         1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
[25] "NUMA node0 CPU(s):                    0-3"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
[26] "Vulnerability Gather data sampling:   Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[27] "Vulnerability Itlb multihit:          Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[28] "Vulnerability L1tf:                   Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[29] "Vulnerability Mds:                    Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[30] "Vulnerability Meltdown:               Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[31] "Vulnerability Mmio stale data:        Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[32] "Vulnerability Reg file data sampling: Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[33] "Vulnerability Retbleed:               Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[34] "Vulnerability Spec rstack overflow:   Vulnerable: Safe RET, no microcode"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
[35] "Vulnerability Spec store bypass:      Vulnerable"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
[36] "Vulnerability Spectre v1:             Mitigation; usercopy/swapgs barriers and __user pointer sanitization"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
[37] "Vulnerability Spectre v2:             Mitigation; Retpolines; STIBP disabled; RSB filling; PBRSB-eIBRS Not affected; BHI Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
[38] "Vulnerability Srbds:                  Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[39] "Vulnerability Tsx async abort:        Not affected"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
[40] "               total        used        free      shared  buff/cache   available"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
[41] "Mem:            15Gi       2.8Gi       3.5Gi        51Mi       9.3Gi        12Gi"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
[42] "Swap:          4.0Gi          0B       4.0Gi"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </code></pre>
</div>
</div>


<!-- -->

</section></main><!-- /main --><div class="giscus">
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/YONGHUNI\.github\.io\/blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org/">Quarto</a> 1.7.34, compiled on GNU/Linux</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Made with ❤️ by <a href="https://yonghuni.github.io/blog/about/me/">YONGHUNI</a></p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb59" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "How to boost a DBSCAN task"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Utilizing High Performance Library from Python"</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Yonghun Suh"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "Sep. 9, 2025"</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Code]</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> https://raw.githubusercontent.com/wangyiqiu/dbscan-python/0.0.12-dev/compare.png</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number_sections: true</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co">    toc_depth: 3</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co">    lightbox: true</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co">#execute:</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  freeze: true</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co">#comments: false</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Backdrop</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="al">![Chat](data/background.jpg)</span>{width=70%}</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span><span class="co">[</span><span class="ot">Frodo, 2:37 PM</span><span class="co">]</span><span class="at"> I'm working on finding representative points for census tracts using nationwide residential building data, weighted by the population of each tract.</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Frodo, 2:38 PM</span><span class="co">]</span><span class="at"> But DBSCAN is taking forever lol, so I'm running it in parallel.</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Frodo, 2:38 PM</span><span class="co">]</span><span class="at"> Using something like the future package in R.</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Yong-Hun Suh, 2:41 PM</span><span class="co">]</span><span class="at"> Yeah, DBSCAN’s time complexity isn’t great…</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Yong-Hun Suh, 4:47 PM</span><span class="co">]</span><span class="at"> Are you still working on that (DBSCAN)?</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Yong-Hun Suh, 4:47 PM</span><span class="co">]</span><span class="at"> If it’s a project you’re going to continue, I can give you a tip…</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Frodo, 4:53 PM</span><span class="co">]</span><span class="at"> Just fixed the code and running it now haha, results should come out in a **few days** if it’s fast.</span><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>I was chatting with my colleague from grad school who said DBSCAN was running too slowly on their project.</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>He had already been using a high speed C++ implementation of DBSCAN in R. Still, however, it was giving eternal waiting.</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>I thought, 'Why not help him out and turn this into a blog article?'</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Analyzing complexity factors**</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is Time Complexity?</span></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>In theoretical computer science, the time complexity is the computational complexity that describes the amount of computer time it takes to run an algorithm. In the plot below, $n$ represents the size of the input, and $N$ represents the number of operations the algorithm performs. This relationship is a critical factor in defining the algorithm's performance, as the efficiency of the algorithm can be assessed by how $N$ changes as the input size $n$ increases.</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Learn more</span><span class="co">](https://en.wikipedia.org/wiki/Time_complexity)</span>{target="_blank"}</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Compirison of Computational Complexity"</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: "It is good to know if the algorithm can handle my problem well!"</span></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "A line plot of Computational Complexity"</span></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Seq `n` gen</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  <span class="co"># need to make the increment small in order to avoid `Inf`s</span></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a><span class="co"># data.table</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n =</span> n,</span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(1)</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(log n)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">log2</span>(n),</span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(n)</span><span class="st">`</span> <span class="ot">=</span> n,</span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(n log n)</span><span class="st">`</span> <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">log2</span>(n),</span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(n^2)</span><span class="st">`</span> <span class="ot">=</span> n<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(2^n)</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span>n,</span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">O(n!)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factorial</span>(n)</span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">melt</span>(df, <span class="at">id.vars =</span> <span class="st">"n"</span>, <span class="at">variable.name =</span> <span class="st">"Complexity"</span>, <span class="at">value.name =</span> <span class="st">"Time"</span>)</span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> Time, <span class="at">color =</span> Complexity)) <span class="sc">+</span></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">100</span>)<span class="sc">+</span></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a>            <span class="co">#title = "Compirison of Computational Complexity",</span></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="st">"Input Size (n)"</span>,</span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="st">"Number of Operations (N)"</span>,</span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"Complexity"</span></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## DBSCAN time complexity</span></span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a>DBSCAN’s runtime is dominated by how you perform neighborhood (range) queries. The classic “it’s $O(n²)$” is only the worst case of a spectrum that depends on data distribution, dimensionality, the index used, and the radius parameter $\varepsilon$.</span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### Core steps and cost drivers</span></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Range queries:** For each point, find all neighbors within radius $\varepsilon$. Distance evaluation for one pair costs $O(d)$ in $d$-dimensional Euclidean space.</span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cluster expansion:** A queue-based flood-fill that repeatedly issues range queries starting from core points (points with at least $\text{minPts}$ neighbors within $\varepsilon$).</span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a>Asymptotically, the number and cost of range queries dominate; the expansion logic is linear in the number of discovered neighbors but tied to the same range-query results.</span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Complexity by neighborhood search strategy</span></span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Brute-force (no index)</span></span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Per range query: compute distance to all points ⇒ $O(n \cdot d)$.</span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>One query per point in the simplest implementation ⇒ $O(n^2 \cdot d)$.</span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cluster expansion may reuse queries or cause repeats; asymptotically the bound remains $\Theta(n^2 \cdot d)$ in the worst case.</span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Space-partitioning trees (kd-tree, ball tree, R-tree-like)</span></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Index build: typically $O(n \log n)$ time, $O(n)$ space.</span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Range query cost:</span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Best/average (well-behaved low–moderate $d$, balanced tree, moderate $\varepsilon$): $O(\log n + k)$, where $k$ is the number of reported neighbors.</span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Worst case (high $d$, large $\varepsilon$, or adversarial data): degenerates to $O(n)$.</span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Overall:</span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Best/average: $O(n \log n + \sum \limits_{i=1}^{n} (\log n + k_i)) = O(n \log n + K)$, where $K = \sum k_i$ is total neighbor reports. If density per query is bounded, $K = O(n)$, giving $O(n \log n)$ plus distance cost factor $O(d)$.</span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Worst: $O(n^2 \cdot d)$.</span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Uniform grid (fixed-radius hashing) in low dimensions</span></span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Build grid hashing once: expected $O(n)$.</span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Range query: constant number of adjacent cells, expected $O(1 + k)$ in 2D/3D if $\varepsilon$ is aligned with cell size and data are not pathologically skewed.</span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Overall in practice: near-linear $O(n + K)$, again with distance cost $O(d)$, but this approach becomes brittle as $d$ grows.</span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In all cases, include the distance computation factor $O(d)$. For high dimensions, tree and grid pruning effectiveness collapses, pushing complexity toward $\Theta(n^2 \cdot d)$.</span></span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## What influences the runtime</span></span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Dimensionality $d$:** Distance costs scale with $O(d)$, and index pruning degrades with the curse of dimensionality, often turning tree queries into $O(n)$.</span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Neighborhood radius $\varepsilon$:** Larger $\varepsilon$ increases average neighbor count $k$, raises $K=\sum k_i$, and triggers more expansions; in the limit, most points neighbor each other ⇒ near $O(n^2 \cdot d)$.</span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Data distribution and density:** Well-separated, roughly uniform, low-density data favor subquadratic performance with indexes. Dense clusters or large connected components increase expansions and repeats.</span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**minPts:** Affects how many points become core (thus how much expansion occurs). It changes constants and practical behavior but not the worst-case big-O bound.</span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Distance metric:** Non-Euclidean metrics can alter pruning efficacy and per-distance cost.</span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Implementation details:** Caching of range queries, deduplication, and “expand only once per point” optimizations materially reduce constants.</span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical scenarios</span></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Scenario <span class="pp">|</span> Assumptions <span class="pp">|</span> Typical complexity <span class="pp">|</span></span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a><span class="pp">|---|---|---|</span></span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Brute-force baseline <span class="pp">|</span> Any $d$, no index <span class="pp">|</span> $\Theta(n^2 \cdot d)$ <span class="pp">|</span></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Tree index, low–moderate $d$ <span class="pp">|</span> Balanced tree, moderate $\varepsilon$, bounded neighbor counts <span class="pp">|</span> $O(n \log n \cdot d)$ <span class="pp">|</span></span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Tree index, high $d$ or large $\varepsilon$ <span class="pp">|</span> Poor pruning, dense neighborhoods <span class="pp">|</span> $\Theta(n^2 \cdot d)$ <span class="pp">|</span></span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Grid index (2D/3D) <span class="pp">|</span> Well-chosen cell size, non-pathological data <span class="pp">|</span> Near $O(n \cdot d)$ <span class="pp">|</span></span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Approximate NN/range <span class="pp">|</span> ANN structure (e.g., HNSW), approximate neighbors <span class="pp">|</span> Subquadratic wall-time; formal bounds vary <span class="pp">|</span></span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The index build cost $O(n \log n)$ (trees) or $O(n)$ (grid) is typically amortized across all range queries.</span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If each point’s neighbor count $k_i$ is bounded by a small constant on average, and pruning works, the total neighbor reports $K$ is $O(n)$, leading to near $O(n \log n)$ behavior with trees.</span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; But... What if you neither can reduce your dataset... nor change the parameter of the DBSCAN?</span></span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-186"><a href="#cb59-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-187"><a href="#cb59-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-188"><a href="#cb59-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution...? At least for this case :)</span></span>
<span id="cb59-189"><a href="#cb59-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-190"><a href="#cb59-190" aria-hidden="true" tabindex="-1"></a>**Use more efficient algorithms that fully leverage your hardware's full potential!**</span>
<span id="cb59-191"><a href="#cb59-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-192"><a href="#cb59-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-193"><a href="#cb59-193" aria-hidden="true" tabindex="-1"></a>For this case, I used <span class="in">`dbscan-python`</span>, which is a high-performance parallel implementation of DBSCAN, based on the SIGMOD 2020 paper “<span class="co">[</span><span class="ot">Theoretically Efficient and Practical Parallel DBSCAN</span><span class="co">](https://github.com/wangyiqiu/dbscan-python)</span>{target="_blank"}.”</span>
<span id="cb59-194"><a href="#cb59-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-195"><a href="#cb59-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-196"><a href="#cb59-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-197"><a href="#cb59-197" aria-hidden="true" tabindex="-1"></a>This work achieves theoretically-efficient clustering by minimizing total work and maintaining polylogarithmic parallel depth, enabling scalable performance on large datasets. </span>
<span id="cb59-198"><a href="#cb59-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-199"><a href="#cb59-199" aria-hidden="true" tabindex="-1"></a>Compared to the naive $O(n^2)$ approach, the proposed algorithm reduces time complexity to $O(n \log n)$ work and $O(\log n)$ depth in 2D, and sub-quadratic work in higher dimensions through grid-based partitioning, parallel union-find, and spatial indexing techniques.</span>
<span id="cb59-200"><a href="#cb59-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-201"><a href="#cb59-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-202"><a href="#cb59-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-203"><a href="#cb59-203" aria-hidden="true" tabindex="-1"></a>As the name of the package implies, I need to use Python again for this experiment.</span>
<span id="cb59-204"><a href="#cb59-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-205"><a href="#cb59-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-206"><a href="#cb59-206" aria-hidden="true" tabindex="-1"></a><span class="fu"># Experiments</span></span>
<span id="cb59-207"><a href="#cb59-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-208"><a href="#cb59-208" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setups</span></span>
<span id="cb59-209"><a href="#cb59-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-210"><a href="#cb59-210" aria-hidden="true" tabindex="-1"></a><span class="fu">### Used R Packages</span></span>
<span id="cb59-211"><a href="#cb59-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-212"><a href="#cb59-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE}</span></span>
<span id="cb59-213"><a href="#cb59-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-214"><a href="#cb59-214" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb59-215"><a href="#cb59-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-216"><a href="#cb59-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-217"><a href="#cb59-217" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb59-218"><a href="#cb59-218" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb59-219"><a href="#cb59-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future.apply)</span>
<span id="cb59-220"><a href="#cb59-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-221"><a href="#cb59-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-222"><a href="#cb59-222" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-223"><a href="#cb59-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-224"><a href="#cb59-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-225"><a href="#cb59-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-226"><a href="#cb59-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-227"><a href="#cb59-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-228"><a href="#cb59-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Setup</span></span>
<span id="cb59-229"><a href="#cb59-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-232"><a href="#cb59-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-233"><a href="#cb59-233" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb59-234"><a href="#cb59-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-235"><a href="#cb59-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-236"><a href="#cb59-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-237"><a href="#cb59-237" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">Sys.info</span>()[[<span class="dv">1</span>]]<span class="sc">==</span><span class="st">"Windows"</span>) {</span>
<span id="cb59-238"><a href="#cb59-238" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-239"><a href="#cb59-239" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For my Windows Environment</span></span>
<span id="cb59-240"><a href="#cb59-240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">use_condaenv</span>(<span class="st">"C:/Users/dydgn/miniforge3/envs/dbscan/python.exe"</span>)</span>
<span id="cb59-241"><a href="#cb59-241" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-242"><a href="#cb59-242" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb59-243"><a href="#cb59-243" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-244"><a href="#cb59-244" aria-hidden="true" tabindex="-1"></a>    <span class="fu">system</span>(<span class="st">"micromamba install -n baseline -c conda-forge dbscan -y"</span>)</span>
<span id="cb59-245"><a href="#cb59-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-246"><a href="#cb59-246" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For github actions to utilize CI/CD</span></span>
<span id="cb59-247"><a href="#cb59-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-248"><a href="#cb59-248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">use_condaenv</span>(<span class="st">"/home/runner/micromamba/envs/baseline/bin/python"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)   </span>
<span id="cb59-249"><a href="#cb59-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-250"><a href="#cb59-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-251"><a href="#cb59-251" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-252"><a href="#cb59-252" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-253"><a href="#cb59-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-254"><a href="#cb59-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-255"><a href="#cb59-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-256"><a href="#cb59-256" aria-hidden="true" tabindex="-1"></a>sys <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"sys"</span>)</span>
<span id="cb59-257"><a href="#cb59-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-258"><a href="#cb59-258" aria-hidden="true" tabindex="-1"></a>sys<span class="sc">$</span>executable</span>
<span id="cb59-259"><a href="#cb59-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-260"><a href="#cb59-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-261"><a href="#cb59-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-262"><a href="#cb59-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-263"><a href="#cb59-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-264"><a href="#cb59-264" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generated Lab Dataset</span></span>
<span id="cb59-265"><a href="#cb59-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-266"><a href="#cb59-266" aria-hidden="true" tabindex="-1"></a>First, I had to replicate a famous dataset for demonstrating DBSCAN.</span>
<span id="cb59-267"><a href="#cb59-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-270"><a href="#cb59-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-271"><a href="#cb59-271" aria-hidden="true" tabindex="-1"></a>generate_random_semicircle <span class="ot">&lt;-</span> <span class="cf">function</span>(center_x, center_y, radius, start_angle, end_angle, <span class="at">n_points =</span> <span class="dv">100</span>, <span class="at">noise =</span> <span class="fl">0.08</span>) {</span>
<span id="cb59-272"><a href="#cb59-272" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-273"><a href="#cb59-273" aria-hidden="true" tabindex="-1"></a>      angles <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_points, <span class="at">min =</span> start_angle, <span class="at">max =</span> end_angle)</span>
<span id="cb59-274"><a href="#cb59-274" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> center_x <span class="sc">+</span> radius <span class="sc">*</span> <span class="fu">cos</span>(angles) <span class="sc">+</span> <span class="fu">rnorm</span>(n_points, <span class="dv">0</span>, noise)</span>
<span id="cb59-275"><a href="#cb59-275" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> center_y <span class="sc">+</span> radius <span class="sc">*</span> <span class="fu">sin</span>(angles) <span class="sc">+</span> <span class="fu">rnorm</span>(n_points, <span class="dv">0</span>, noise)</span>
<span id="cb59-276"><a href="#cb59-276" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb59-277"><a href="#cb59-277" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">as.data.table</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)))</span>
<span id="cb59-278"><a href="#cb59-278" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-279"><a href="#cb59-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-280"><a href="#cb59-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-281"><a href="#cb59-281" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-282"><a href="#cb59-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-283"><a href="#cb59-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-284"><a href="#cb59-284" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e+5</span>L</span>
<span id="cb59-285"><a href="#cb59-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-286"><a href="#cb59-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-287"><a href="#cb59-287" aria-hidden="true" tabindex="-1"></a>semicircle1 <span class="ot">&lt;-</span> <span class="fu">generate_random_semicircle</span>(<span class="at">center_x =</span> <span class="dv">0</span>, <span class="at">center_y =</span> <span class="fl">0.25</span>, <span class="at">radius =</span> <span class="dv">1</span>,</span>
<span id="cb59-288"><a href="#cb59-288" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">start_angle =</span> pi, <span class="at">end_angle =</span> <span class="dv">2</span> <span class="sc">*</span> pi, <span class="at">n_points =</span> N)</span>
<span id="cb59-289"><a href="#cb59-289" aria-hidden="true" tabindex="-1"></a>semicircle1[, group <span class="sc">:</span><span class="er">=</span> <span class="st">"Semicircle 1"</span>]</span>
<span id="cb59-290"><a href="#cb59-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-291"><a href="#cb59-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-292"><a href="#cb59-292" aria-hidden="true" tabindex="-1"></a>semicircle2 <span class="ot">&lt;-</span> <span class="fu">generate_random_semicircle</span>(<span class="at">center_x =</span> <span class="dv">1</span>, <span class="at">center_y =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">radius =</span> <span class="dv">1</span>,</span>
<span id="cb59-293"><a href="#cb59-293" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">start_angle =</span> <span class="dv">0</span>, <span class="at">end_angle =</span> pi, <span class="at">n_points =</span> N)</span>
<span id="cb59-294"><a href="#cb59-294" aria-hidden="true" tabindex="-1"></a>semicircle2[, group <span class="sc">:</span><span class="er">=</span> <span class="st">"Semicircle 2"</span>]</span>
<span id="cb59-295"><a href="#cb59-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-296"><a href="#cb59-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-297"><a href="#cb59-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-298"><a href="#cb59-298" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(<span class="fu">list</span>(semicircle1, semicircle2))</span>
<span id="cb59-299"><a href="#cb59-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-300"><a href="#cb59-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-301"><a href="#cb59-301" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization</span></span>
<span id="cb59-302"><a href="#cb59-302" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb59-303"><a href="#cb59-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-304"><a href="#cb59-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-305"><a href="#cb59-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-306"><a href="#cb59-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Randomized Overlapping Semicircles"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb59-307"><a href="#cb59-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb59-308"><a href="#cb59-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-309"><a href="#cb59-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-310"><a href="#cb59-310" aria-hidden="true" tabindex="-1"></a>lab_data <span class="ot">&lt;-</span> df[, <span class="sc">!</span><span class="fu">c</span>(<span class="st">"group"</span>), with <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb59-311"><a href="#cb59-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-312"><a href="#cb59-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-313"><a href="#cb59-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-314"><a href="#cb59-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-315"><a href="#cb59-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-316"><a href="#cb59-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-317"><a href="#cb59-317" aria-hidden="true" tabindex="-1"></a><span class="fu">### R - Naive</span></span>
<span id="cb59-318"><a href="#cb59-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-321"><a href="#cb59-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-322"><a href="#cb59-322" aria-hidden="true" tabindex="-1"></a>lab_data_r <span class="ot">&lt;-</span> lab_data</span>
<span id="cb59-323"><a href="#cb59-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-324"><a href="#cb59-324" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span>  .<span class="dv">08</span></span>
<span id="cb59-325"><a href="#cb59-325" aria-hidden="true" tabindex="-1"></a>minpts <span class="ot">&lt;-</span> <span class="dv">200</span>L <span class="co">#should be an integer for the python env</span></span>
<span id="cb59-326"><a href="#cb59-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-327"><a href="#cb59-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-328"><a href="#cb59-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-329"><a href="#cb59-329" aria-hidden="true" tabindex="-1"></a>stime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb59-330"><a href="#cb59-330" aria-hidden="true" tabindex="-1"></a>db_result_r <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(lab_data_r, <span class="at">eps =</span> epsilon, <span class="at">minPts =</span> minpts)</span>
<span id="cb59-331"><a href="#cb59-331" aria-hidden="true" tabindex="-1"></a>etime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb59-332"><a href="#cb59-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-333"><a href="#cb59-333" aria-hidden="true" tabindex="-1"></a>delta_t_r <span class="ot">&lt;-</span> etime<span class="sc">-</span>stime; delta_t_r</span>
<span id="cb59-334"><a href="#cb59-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-335"><a href="#cb59-335" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb59-336"><a href="#cb59-336" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(db_result_r<span class="sc">$</span>cluster)</span>
<span id="cb59-337"><a href="#cb59-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-338"><a href="#cb59-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-339"><a href="#cb59-339" aria-hidden="true" tabindex="-1"></a>lab_data_r<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(db_result_r<span class="sc">$</span>cluster)</span>
<span id="cb59-340"><a href="#cb59-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-341"><a href="#cb59-341" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization</span></span>
<span id="cb59-342"><a href="#cb59-342" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lab_data_r, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb59-343"><a href="#cb59-343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-344"><a href="#cb59-344" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-345"><a href="#cb59-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-346"><a href="#cb59-346" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Randomized Overlapping Semicircles"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb59-347"><a href="#cb59-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb59-348"><a href="#cb59-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-349"><a href="#cb59-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-350"><a href="#cb59-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-351"><a href="#cb59-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-352"><a href="#cb59-352" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python - `wangyiqiu/dbscan-python`</span></span>
<span id="cb59-353"><a href="#cb59-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-356"><a href="#cb59-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-357"><a href="#cb59-357" aria-hidden="true" tabindex="-1"></a>lab_data_py <span class="ot">&lt;-</span> lab_data</span>
<span id="cb59-358"><a href="#cb59-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-359"><a href="#cb59-359" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>lab_data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(lab_data_py)</span>
<span id="cb59-360"><a href="#cb59-360" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>epsilon <span class="ot">&lt;-</span> epsilon</span>
<span id="cb59-361"><a href="#cb59-361" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>minpts <span class="ot">&lt;-</span> minpts</span>
<span id="cb59-362"><a href="#cb59-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-363"><a href="#cb59-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-364"><a href="#cb59-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-365"><a href="#cb59-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-366"><a href="#cb59-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-369"><a href="#cb59-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb59-370"><a href="#cb59-370" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb59-371"><a href="#cb59-371" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dbscan <span class="im">import</span> DBSCAN</span>
<span id="cb59-372"><a href="#cb59-372" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb59-373"><a href="#cb59-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-374"><a href="#cb59-374" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"type(X):"</span>, <span class="bu">type</span>(lab_data))</span>
<span id="cb59-375"><a href="#cb59-375" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape(X):"</span>, <span class="bu">getattr</span>(lab_data, <span class="st">'shape'</span>, <span class="va">None</span>))</span>
<span id="cb59-376"><a href="#cb59-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-377"><a href="#cb59-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-378"><a href="#cb59-378" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time.time()</span>
<span id="cb59-379"><a href="#cb59-379" aria-hidden="true" tabindex="-1"></a>labels, core_samples_mask <span class="op">=</span> DBSCAN(lab_data, eps <span class="op">=</span> epsilon, min_samples <span class="op">=</span> minpts)</span>
<span id="cb59-380"><a href="#cb59-380" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> time.time()</span>
<span id="cb59-381"><a href="#cb59-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-382"><a href="#cb59-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-383"><a href="#cb59-383" aria-hidden="true" tabindex="-1"></a>delta_t <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb59-384"><a href="#cb59-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-385"><a href="#cb59-385" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Elapsed time: </span><span class="sc">{</span>delta_t<span class="sc">:.4f}</span><span class="ss"> seconds"</span>)</span>
<span id="cb59-386"><a href="#cb59-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-387"><a href="#cb59-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-388"><a href="#cb59-388" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과를 R로 반환</span></span>
<span id="cb59-389"><a href="#cb59-389" aria-hidden="true" tabindex="-1"></a><span class="co">#r.labels = labels</span></span>
<span id="cb59-390"><a href="#cb59-390" aria-hidden="true" tabindex="-1"></a><span class="co">#r.core_mask = core_samples_mask</span></span>
<span id="cb59-391"><a href="#cb59-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-392"><a href="#cb59-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-393"><a href="#cb59-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-394"><a href="#cb59-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-395"><a href="#cb59-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-396"><a href="#cb59-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-397"><a href="#cb59-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-400"><a href="#cb59-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-401"><a href="#cb59-401" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb59-402"><a href="#cb59-402" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(py<span class="sc">$</span>labels)</span>
<span id="cb59-403"><a href="#cb59-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-404"><a href="#cb59-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-405"><a href="#cb59-405" aria-hidden="true" tabindex="-1"></a>lab_data_py<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(py<span class="sc">$</span>labels<span class="sc">+</span><span class="dv">1</span>) <span class="co"># as index number starts from 0</span></span>
<span id="cb59-406"><a href="#cb59-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-407"><a href="#cb59-407" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization</span></span>
<span id="cb59-408"><a href="#cb59-408" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lab_data_py, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb59-409"><a href="#cb59-409" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-410"><a href="#cb59-410" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-411"><a href="#cb59-411" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-412"><a href="#cb59-412" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Randomized Overlapping Semicircles"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb59-413"><a href="#cb59-413" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb59-414"><a href="#cb59-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-415"><a href="#cb59-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-416"><a href="#cb59-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-417"><a href="#cb59-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-418"><a href="#cb59-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb59-419"><a href="#cb59-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-422"><a href="#cb59-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-423"><a href="#cb59-423" aria-hidden="true" tabindex="-1"></a><span class="co">#speedup</span></span>
<span id="cb59-424"><a href="#cb59-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-425"><a href="#cb59-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-426"><a href="#cb59-426" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(delta_t_r[[<span class="dv">1</span>]]<span class="sc">/</span>py<span class="sc">$</span>delta_t,<span class="st">" times speed-up</span><span class="sc">\n</span><span class="st">"</span>,<span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb59-427"><a href="#cb59-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-428"><a href="#cb59-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-429"><a href="#cb59-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-430"><a href="#cb59-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-431"><a href="#cb59-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-432"><a href="#cb59-432" aria-hidden="true" tabindex="-1"></a><span class="fu">## Some Real World Dataset</span></span>
<span id="cb59-433"><a href="#cb59-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-434"><a href="#cb59-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-435"><a href="#cb59-435" aria-hidden="true" tabindex="-1"></a>Source: <span class="co">[</span><span class="ot">NYC Taxi Data</span><span class="co">](https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page)</span></span>
<span id="cb59-436"><a href="#cb59-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-439"><a href="#cb59-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-440"><a href="#cb59-440" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb59-441"><a href="#cb59-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-442"><a href="#cb59-442" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-"</span>,<span class="fu">sprintf</span>(<span class="st">"%02d"</span>, <span class="dv">1</span><span class="sc">:</span>months),<span class="st">".parquet"</span>)</span>
<span id="cb59-443"><a href="#cb59-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-444"><a href="#cb59-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-445"><a href="#cb59-445" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession,<span class="at">workers =</span> <span class="dv">2</span>)</span>
<span id="cb59-446"><a href="#cb59-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-447"><a href="#cb59-447" aria-hidden="true" tabindex="-1"></a>taxi_list <span class="ot">&lt;-</span> <span class="fu">future_lapply</span>(urls, <span class="cf">function</span>(url) <span class="fu">as.data.table</span>(<span class="fu">read_parquet</span>(url))) <span class="sc">|&gt;</span> <span class="fu">rbindlist</span>()</span>
<span id="cb59-448"><a href="#cb59-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-449"><a href="#cb59-449" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb59-450"><a href="#cb59-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-451"><a href="#cb59-451" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(taxi_list)</span>
<span id="cb59-452"><a href="#cb59-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-453"><a href="#cb59-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-454"><a href="#cb59-454" aria-hidden="true" tabindex="-1"></a><span class="co"># select numeric rows &amp; filtering out NAs</span></span>
<span id="cb59-455"><a href="#cb59-455" aria-hidden="true" tabindex="-1"></a>taxi_numeric_dt <span class="ot">&lt;-</span> taxi_list[</span>
<span id="cb59-456"><a href="#cb59-456" aria-hidden="true" tabindex="-1"></a>    trip_distance <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> fare_amount <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(trip_distance) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(fare_amount),</span>
<span id="cb59-457"><a href="#cb59-457" aria-hidden="true" tabindex="-1"></a>    .(trip_distance, fare_amount)</span>
<span id="cb59-458"><a href="#cb59-458" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb59-459"><a href="#cb59-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-460"><a href="#cb59-460" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(taxi_list)</span>
<span id="cb59-461"><a href="#cb59-461" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb59-462"><a href="#cb59-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-463"><a href="#cb59-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-464"><a href="#cb59-464" aria-hidden="true" tabindex="-1"></a>taxi_numeric_dt_200k <span class="ot">&lt;-</span> taxi_numeric_dt[<span class="fu">sample</span>(.N, <span class="dv">200000</span>)]</span>
<span id="cb59-465"><a href="#cb59-465" aria-hidden="true" tabindex="-1"></a><span class="co">#taxi_numeric_dt_10m &lt;- taxi_numeric_dt[sample(.N, 10000000)]</span></span>
<span id="cb59-466"><a href="#cb59-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-467"><a href="#cb59-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-468"><a href="#cb59-468" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>taxi_numeric_dt_200k <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(taxi_numeric_dt_200k)</span>
<span id="cb59-469"><a href="#cb59-469" aria-hidden="true" tabindex="-1"></a><span class="co">#py$taxi_numeric_dt_10m &lt;- as.matrix(taxi_numeric_dt_10m)</span></span>
<span id="cb59-470"><a href="#cb59-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-471"><a href="#cb59-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-472"><a href="#cb59-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-473"><a href="#cb59-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-474"><a href="#cb59-474" aria-hidden="true" tabindex="-1"></a><span class="fu">### R - Naive</span></span>
<span id="cb59-475"><a href="#cb59-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-478"><a href="#cb59-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-479"><a href="#cb59-479" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span>  <span class="fl">0.3</span></span>
<span id="cb59-480"><a href="#cb59-480" aria-hidden="true" tabindex="-1"></a>minpts <span class="ot">&lt;-</span> <span class="dv">10</span>L</span>
<span id="cb59-481"><a href="#cb59-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-482"><a href="#cb59-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-483"><a href="#cb59-483" aria-hidden="true" tabindex="-1"></a>stime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb59-484"><a href="#cb59-484" aria-hidden="true" tabindex="-1"></a>db_result_r <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(taxi_numeric_dt_200k, <span class="at">eps =</span> epsilon, <span class="at">minPts =</span> minpts)</span>
<span id="cb59-485"><a href="#cb59-485" aria-hidden="true" tabindex="-1"></a>etime <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb59-486"><a href="#cb59-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-487"><a href="#cb59-487" aria-hidden="true" tabindex="-1"></a>delta_t_r <span class="ot">&lt;-</span> etime<span class="sc">-</span>stime; delta_t_r</span>
<span id="cb59-488"><a href="#cb59-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-489"><a href="#cb59-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-490"><a href="#cb59-490" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(db_result_r<span class="sc">$</span>cluster)</span>
<span id="cb59-491"><a href="#cb59-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-492"><a href="#cb59-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-493"><a href="#cb59-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-494"><a href="#cb59-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-495"><a href="#cb59-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-496"><a href="#cb59-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-497"><a href="#cb59-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python - `wangyiqiu/dbscan-python`</span></span>
<span id="cb59-498"><a href="#cb59-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-501"><a href="#cb59-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-502"><a href="#cb59-502" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>taxi_numeric_dt_200k <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(taxi_numeric_dt_200k)</span>
<span id="cb59-503"><a href="#cb59-503" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>epsilon <span class="ot">&lt;-</span> epsilon</span>
<span id="cb59-504"><a href="#cb59-504" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>minpts <span class="ot">&lt;-</span> minpts</span>
<span id="cb59-505"><a href="#cb59-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-506"><a href="#cb59-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-507"><a href="#cb59-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-508"><a href="#cb59-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-509"><a href="#cb59-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-512"><a href="#cb59-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb59-513"><a href="#cb59-513" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb59-514"><a href="#cb59-514" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dbscan <span class="im">import</span> DBSCAN</span>
<span id="cb59-515"><a href="#cb59-515" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb59-516"><a href="#cb59-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-517"><a href="#cb59-517" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"type(X):"</span>, <span class="bu">type</span>(taxi_numeric_dt_200k))</span>
<span id="cb59-518"><a href="#cb59-518" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape(X):"</span>, <span class="bu">getattr</span>(taxi_numeric_dt_200k, <span class="st">'shape'</span>, <span class="va">None</span>))</span>
<span id="cb59-519"><a href="#cb59-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-520"><a href="#cb59-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-521"><a href="#cb59-521" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> time.time()</span>
<span id="cb59-522"><a href="#cb59-522" aria-hidden="true" tabindex="-1"></a>labels, core_samples_mask <span class="op">=</span> DBSCAN(taxi_numeric_dt_200k, eps<span class="op">=</span><span class="fl">0.3</span>, min_samples<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb59-523"><a href="#cb59-523" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> time.time()</span>
<span id="cb59-524"><a href="#cb59-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-525"><a href="#cb59-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-526"><a href="#cb59-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-527"><a href="#cb59-527" aria-hidden="true" tabindex="-1"></a>delta_t <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb59-528"><a href="#cb59-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-529"><a href="#cb59-529" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Elapsed time: </span><span class="sc">{</span>delta_t<span class="sc">:.4f}</span><span class="ss"> seconds"</span>)</span>
<span id="cb59-530"><a href="#cb59-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-531"><a href="#cb59-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-532"><a href="#cb59-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-533"><a href="#cb59-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-534"><a href="#cb59-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-535"><a href="#cb59-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-536"><a href="#cb59-536" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb59-537"><a href="#cb59-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-538"><a href="#cb59-538" aria-hidden="true" tabindex="-1"></a>The code below shows the results are valid, as it counts how many rows are assigned to each label, sorts the counts in ascending order, and returns the difference between the two label distributions.</span>
<span id="cb59-539"><a href="#cb59-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-542"><a href="#cb59-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-543"><a href="#cb59-543" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">as.vector</span>(<span class="fu">table</span>(<span class="fu">as.factor</span>(py<span class="sc">$</span>labels)))) <span class="sc">-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(<span class="fu">table</span>(<span class="fu">as.factor</span>(db_result_r<span class="sc">$</span>cluster))))</span>
<span id="cb59-544"><a href="#cb59-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-545"><a href="#cb59-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-546"><a href="#cb59-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-547"><a href="#cb59-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-548"><a href="#cb59-548" aria-hidden="true" tabindex="-1"></a>A slight difference is observed. but it appears to stem from floating-point or grid based operations, hence it is negligible.</span>
<span id="cb59-549"><a href="#cb59-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-550"><a href="#cb59-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-553"><a href="#cb59-553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-554"><a href="#cb59-554" aria-hidden="true" tabindex="-1"></a><span class="co">#speedup</span></span>
<span id="cb59-555"><a href="#cb59-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-556"><a href="#cb59-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-557"><a href="#cb59-557" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(delta_t_r[[<span class="dv">1</span>]]<span class="sc">/</span>py<span class="sc">$</span>delta_t,<span class="st">" times speed-up</span><span class="sc">\n</span><span class="st">"</span>,<span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb59-558"><a href="#cb59-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-559"><a href="#cb59-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-560"><a href="#cb59-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-561"><a href="#cb59-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-562"><a href="#cb59-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-563"><a href="#cb59-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-564"><a href="#cb59-564" aria-hidden="true" tabindex="-1"></a>What a whopping improvement isn't it?</span>
<span id="cb59-565"><a href="#cb59-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-566"><a href="#cb59-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-567"><a href="#cb59-567" aria-hidden="true" tabindex="-1"></a><span class="fu"># Take-home message</span></span>
<span id="cb59-568"><a href="#cb59-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-569"><a href="#cb59-569" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="DBSCAN is a slow algorithm"}</span>
<span id="cb59-570"><a href="#cb59-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-571"><a href="#cb59-571" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Worst-case time: $\Theta(n^2 \cdot d)$ regardless of indexing.</span>
<span id="cb59-572"><a href="#cb59-572" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Well-behaved low-dimensional data with effective indexing can approach $O(n \log n \cdot d)$.</span>
<span id="cb59-573"><a href="#cb59-573" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As $d$ or $\varepsilon$ grow, expect degradation toward quadratic behavior.</span>
<span id="cb59-574"><a href="#cb59-574" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tuning $\varepsilon$, choosing appropriate indexes, and reducing $d$ (e.g., via PCA) often matter more than micro-optimizations.</span>
<span id="cb59-575"><a href="#cb59-575" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If you cannot apply the above strategies, **use a high-performance implementation**.</span>
<span id="cb59-576"><a href="#cb59-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-577"><a href="#cb59-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-578"><a href="#cb59-578" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-579"><a href="#cb59-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-580"><a href="#cb59-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-581"><a href="#cb59-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-582"><a href="#cb59-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-583"><a href="#cb59-583" aria-hidden="true" tabindex="-1"></a><span class="fu"># Environment info</span></span>
<span id="cb59-584"><a href="#cb59-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-587"><a href="#cb59-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-588"><a href="#cb59-588" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb59-589"><a href="#cb59-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-590"><a href="#cb59-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-591"><a href="#cb59-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-594"><a href="#cb59-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-595"><a href="#cb59-595" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">Sys.info</span>()[[<span class="dv">1</span>]]<span class="sc">==</span><span class="st">"Windows"</span>) {</span>
<span id="cb59-596"><a href="#cb59-596" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-597"><a href="#cb59-597" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For my Windows Environment</span></span>
<span id="cb59-598"><a href="#cb59-598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">system</span>(<span class="st">"systeminfo"</span>,<span class="at">intern =</span> T)</span>
<span id="cb59-599"><a href="#cb59-599" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-600"><a href="#cb59-600" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-601"><a href="#cb59-601" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb59-602"><a href="#cb59-602" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-603"><a href="#cb59-603" aria-hidden="true" tabindex="-1"></a>    <span class="fu">system</span>(<span class="st">"lscpu; free -h"</span>,<span class="at">intern =</span> T)</span>
<span id="cb59-604"><a href="#cb59-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-605"><a href="#cb59-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-606"><a href="#cb59-606" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-607"><a href="#cb59-607" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-608"><a href="#cb59-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-609"><a href="#cb59-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-610"><a href="#cb59-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-611"><a href="#cb59-611" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div>


</body></html>